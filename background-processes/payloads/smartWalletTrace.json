{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/schemas/scanReport.json",
  "title": "ScanReport",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "scanReportId": {
      "type": "string",
      "description": "Unique identifier for this scan report"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO-8601 timestamp when the scan was performed"
    },
    "engine": {
      "type": "string",
      "description": "Name or version of the scanning engine"
    },
    "tokenData": {
      "$ref": "#/definitions/TokenData"
    },
    "riskIndicators": {
      "$ref": "#/definitions/RiskIndicators"
    },
    "telemetry": {
      "$ref": "#/definitions/Telemetry"
    },
    "observations": {
      "$ref": "#/definitions/ObservationArray"
    },
    "assessment": {
      "$ref": "#/definitions/Assessment"
    }
  },
  "required": [
    "scanReportId",
    "timestamp",
    "engine",
    "tokenData",
    "riskIndicators",
    "telemetry",
    "observations",
    "assessment"
  ],
  "definitions": {
    "TokenData": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "symbol": {
          "type": "string",
          "description": "Token ticker symbol"
        },
        "mint": {
          "type": "string",
          "description": "Token mint address"
        },
        "status": {
          "type": "string",
          "enum": ["unverified", "verified", "suspicious", "safe"],
          "description": "Overall verification status"
        },
        "launchWindow": {
          "type": "string",
          "format": "date-time",
          "description": "Token's launch date-time window"
        }
      },
      "required": ["symbol", "mint", "status", "launchWindow"]
    },
    "RiskIndicators": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "dexLiquidityDrop": {
          "type": "boolean",
          "description": "Significant drop in DEX liquidity observed"
        },
        "initMintInLast6h": {
          "type": "boolean",
          "description": "Mint occurred in the last 6 hours"
        },
        "whaleAbsence": {
          "type": "boolean",
          "description": "Lack of large holder activity"
        },
        "clusterBehaviorScore": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "AI-derived cluster behavior risk score (0–100)"
        }
      },
      "required": [
        "dexLiquidityDrop",
        "initMintInLast6h",
        "whaleAbsence",
        "clusterBehaviorScore"
      ]
    },
    "Telemetry": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "liquidityChangePercent": {
          "type": "number",
          "description": "Percentage change in liquidity"
        },
        "volume24h_SOL": {
          "type": "number",
          "description": "24-hour trading volume in SOL"
        },
        "priceFluctuation": {
          "type": "number",
          "description": "Percent price fluctuation over 24h"
        },
        "uniqueBuyers": {
          "type": "integer",
          "minimum": 0,
          "description": "Count of unique buyer addresses"
        },
        "smartWalletInteractions": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of interactions by smart wallets"
        },
        "linkedContracts": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of linked smart contracts called"
        }
      },
      "required": [
        "liquidityChangePercent",
        "volume24h_SOL",
        "priceFluctuation",
        "uniqueBuyers",
        "smartWalletInteractions",
        "linkedContracts"
      ]
    },
    "Observation": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "tag": {
          "type": "string",
          "description": "Short label for the observation"
        },
        "detail": {
          "type": "string",
          "description": "Detailed description of the observation"
        }
      },
      "required": ["tag", "detail"]
    },
    "ObservationArray": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/definitions/Observation" }
    },
    "Assessment": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "threatTier": {
          "type": "string",
          "enum": ["Low", "Moderate", "High", "Critical"],
          "description": "Overall threat level"
        },
        "recommendation": {
          "type": "string",
          "description": "Recommended next steps"
        },
        "certainty": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in this assessment (0.0–1.0)"
        }
      },
      "required": ["threatTier", "recommendation", "certainty"]
    }
  }
}
